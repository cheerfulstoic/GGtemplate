= Telco Network Management Using Graph Database

== Introduction

=== The Problem

Telecommunication companies need a way to predict and warn customers in advance of any service interruptions in order to maintain customer service agreements and avoid financial penalties of unplanned downtime.

=== The Challenge

Among the challenges were: sourcing and transforming data from more than 30 systems into a single system that had to hold the up-to-date topology for the entire network, and being able to query that system efficiently, answering questions like: if a device needs to be taken down for maintenance, who might be impacted, and what alternate routes might be used to mitigate the impact.

== The Network

[ image of telco network from Neo4j presentation/whitepaper ]

//set up graphgist with a graph that looks very similar to this but with nicer subgraph for demonstration of a semi-realistic SRLG issue, which will be described below

//hide
//setup
[source,cypher]
----
//create the resource nodes
CREATE (`1` :subgraph:crew {crew_id:1, name:'Abeer Fathy'}), (`2` :subgraph:crew {crew_id:2, name:'An Yu-bao'}), (`3` :subgraph:crew {crew_id:3, name:'Anastasiya Vasilyev'}), (`4` :subgraph:crew {crew_id:4, name:'Anna Zaytesev'}), (`5` :subgraph:crew {crew_id:5, name:'Asley Leger'}), (`6`:crew {crew_id:6, name:'Aziza Hsuang-tsung'}), (`7`:crew {crew_id:7, name:'Bai Vasilyev'}), (`8`:crew {crew_id:8, name:'Barbra Schon'}), (`9`:crew {crew_id:9, name:'Bart Kosana'}), (`10`:crew {crew_id:10, name:'Bill Hinzman'}), (`11`:crew {crew_id:11, name:'Bill Cardille'}), (`12`:crew {crew_id:12, name:'Bobba Fett'}), (`13`:crew {crew_id:13, name:'Cai Shen'}), (`14` :service {service_id:1, name:'Cammy Schott'}), (`15`:crew {crew_id:15, name:'Cammy Vinogradov'})

//create the channels
CREATE (`1`)-[:KNOWS]->(`2`), (`1`)-[:KNOWS]->(`4`), (`1`)-[:KNOWS]->(`3`), (`2`)-[:KNOWS]->(`3`), (`2`)-[:KNOWS]->(`4`), (`3`)-[:KNOWS]->(`5`), (`4`)-[:KNOWS]->(`5`),(`14`)-[:KNOWS]->(`13`),(`14`)-[:KNOWS]->(`8`),(`14`)-[:KNOWS]->(`7`),(`7`)-[:KNOWS]->(`6`),(`8`)-[:KNOWS]->(`9`),(`13`)-[:KNOWS]->(`10`),(`10`)-[:KNOWS]->(`11`),(`10`)-[:KNOWS]->(`12`),(`12`)-[:KNOWS]->(`11`),(`13`)-[:KNOWS]->(`8`), (`7`)-[:KNOWS]->(`8`), (`8`)-[:KNOWS]->(`6`),(`6`)-[:KNOWS]->(`1`),(`15`)-[:KNOWS]->(`9`),(`13`)-[:KNOWS]->(`9`)
----
//graph

- Briefly go over the cypher for people are interested in learning cypher
-- in this example I'm calling the nodes 'resources' and the relationships 'channels'
-- channels can have 3 different states: 'open', 'closed', or 'broken'
-- there are two types of nodes: crew (to be changed later) and service
- The full toy graph will have network information spread across > 30 systems, with daily changes to network infrastructure
-- now
-- Will demonstrate that the graph can hold the up-to-date topology for the entire network

== Solving the Problems

=== Uncovering the Need for Additional Redundancy

==== Finding and dealing with bridges

A bridge refers to an edge (or in Neo4j, a relationship), that when deleted, increases the number of connected components. In the example below, both edge a or b could be bridges, as their deletion would result in two connected components, only one of which would include Bob. 

image::http://i.imgur.com/DvwWxMI.png[example]

_replace this image with an image of this network, update names_

Let's find bridges in our network:

[source,cypher]
----
MATCH path =(a:crew)-[r0]->(b:crew)
WHERE NOT (a)-[*2]-(b) AND NOT (a)<--(b)
RETURN DISTINCT a.crew_id AS `Endpoint 1 ID`, a.name AS `Endpoint 1 Name`, b.crew_id AS `Endpoint 2 ID`, b.name AS `Endpoint 2 Name`, r0
----

_insert images of the bridges_

_insert description of what's going on at each bridge_ 

Naturally, if anything happens to any of these channels a chunk of of our network will go down. Ideally, we'd have redundancies and multiple backups to take care of any possible outage. However, resources and the implementation of resources are expensive. 

=== Resilience During Unplanned Network Outages

==== Introduction

Let's take a look at the subgraph connected by the bridge between network resource _Abeer Fathy_ and _Aziza Hsuang-tsung_. 

_insert detailed diagram of this subgraph_

The need for additional connections evident: if a drunk driver or nest of squirreles were to eliminate this bridge, the entire subgraph will go down. The next question: Assuming the owner of the netowrk has the funds for only one additional link to the subgraph, what is the optimal location to place it? 

For this example, let's make the following assumptions about the network and the network owners' needs:

- While resource A is communicating with resource B through a channel or set of channels, no other resource can use the channels for the duration of the communication. 
- Resources, including bridge components _Abeer Fathy_ and _Aziza Hsuang-tsung_, are very robust and are unlikely to fail 
- When it rains it pours: We are trying to determine where to place additional channels based on the worst case scenario. 
 * More than one channel will fail at the same time, and we know the channels between resource 3 and 1 and 3 and 2 are in a particularly vulnerable area. 
 * During crisis all resources will be trying to reach the parent network simultaneously

SOMETHING HERE 



== Conclusion/Discussion

=== more conclusion copy

conclusion stuff

=== Sub-graph Fault Tolerant Routing

_Subgraph Fault-Tolerant Routing (SFTR)_ is a strategy for planning for the inevitable - resource or connection outage. Sometimes a squirrel builds a nest in part of your network. Although we have to accept that parts of our networks will break, we can also determine which components will be able to reroute and which will have the potential to be catastrophic failures.

L+1 sub-graph routing is a strategy for routing dependable connections in optical networks. In this approach each network is mapped into L distinct sub-graphs resulting from the removal of links (in this example, only one link) from the original network.

A connection from node A to B in this scheme becomes “accepted”–in other words, identified as not potentially catastrophic–only if it is there is a path from A to B in all sub-graphs. Ideally, we would design a network in which there is always a path from A to B given any network failure.

=== Why Neo4j?

The problem of modeling a live Telco network was a good fit for Neo4j’s solution, which uses nodes and relationships to describe assets on the network (switches, routers, cell towers), and the links between them (trunks, fiber optic cables, VPNs). Neo4j places no restrictions on the way the data is structured, or the data that is captured: it can model and represent the new network in a natural way. This extreme flexibility saves a great deal of time, and makes it possible to represent complex data and abstract concepts at the same time, within the same database. This is extremely powerful.

=== Additional things telcos need to worry about that neo4j could help solve

== Actual Use Case: Vivendi SFR

- Second largest communications company in France
- Part of Vivendi Group, partnering with Vodafone

SFR tasked a 10-person project team to find a network management solution, and brought in software consultants from London-based OpenCredo to provide best practice expertise. The team selected the Neo4j graph database to build a proof of concept app that could pinpoint any “single point of failure” across the components of the SFR multi-system network.

== Cypher Appendix

Briefly go over the queries in more detail

=== Setting up the Graph

=== Uncovering the Need for Additional Redundancy

==== Finding Bridges

==== Adding Bridges

=== Resilience During Unplanned Network Outages

==== Removing Links

==== Finding (the best) secondary routes for emergencies

== References

- those two Frederick et al papers
- Neo4j ‘intro slides’ and graph connect presentations
- Neo4j telco white paper
- 'http://en.wikipedia.org/wiki/Samuel_Johnson[Networks, Crowds, and Markets]'
- 'http://jexp.de/blog/2014/03/sampling-a-neo4j-database/[Sampling a Neo4j Database]'
